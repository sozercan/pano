import{a as c,j as e}from"./query-0GDLkmRH.js";import{c as je,K as f,a as j,b as ye,p as Ne,S as Ce,X as G,C as we,d as Fe,i as Q,e as Pe}from"./index-BMNPQyWO.js";import{s as Ee,e as Te,t as ke,g as Se,v as H,f as ee,k as R,A as te,m as re,w as Re,x as Ae,y as se,z as Oe,B as _e,l as Ie,D as Le,F as Me,E as De,G as $e,R as Ke,T as Ge,P as Ue,C as We,I as ze,n as Ve,o as Be,O as Ze,p as Xe,q as Ye,r as qe}from"./ui-BnO7LcMU.js";import"./router-PuTsyGi-.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=je("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function Qe({itemCount:r,itemHeight:t,containerHeight:s,overscan:l=5}){const[n,a]=c.useState(0),i=c.useRef(null),o=c.useCallback(d=>{const x=d.currentTarget;a(x.scrollTop)},[]),{virtualItems:p,offsetTop:u}=c.useMemo(()=>{if(r===0)return{virtualItems:[],offsetTop:0};const d=Math.max(0,Math.floor(n/t)-l),x=Math.min(r-1,Math.ceil((n+s)/t)+l),g=[];for(let b=d;b<=x;b++)g.push({index:b,offsetTop:b*t,height:t});return{virtualItems:g,offsetTop:d*t}},[r,t,s,n,l]),m=r*t,h=c.useCallback((d,x="start")=>{if(!i.current)return;let g;const b=d*t;switch(x){case"center":g=b-s/2+t/2;break;case"end":g=b-s+t;break;case"start":default:g=b;break}g=Math.max(0,Math.min(g,m-s)),i.current.scrollTop=g},[t,s,m]);return{virtualItems:p,totalHeight:m,offsetTop:u,scrollTop:n,onScroll:o,scrollRef:i,scrollToIndex:h}}function He(r=600){const[t,s]=c.useState(r),l=c.useRef(null);return c.useEffect(()=>{const n=l.current;if(!n)return;const a=new ResizeObserver(i=>{for(const o of i)s(o.contentRect.height)});return a.observe(n),()=>a.disconnect()},[]),{height:t,containerRef:l}}function et(r){const t=tt(r),s=c.forwardRef((l,n)=>{const{children:a,...i}=l,o=c.Children.toArray(a),p=o.find(st);if(p){const u=p.props.children,m=o.map(h=>h===p?c.Children.count(u)>1?c.Children.only(null):c.isValidElement(u)?u.props.children:null:h);return e.jsx(t,{...i,ref:n,children:c.isValidElement(u)?c.cloneElement(u,void 0,m):null})}return e.jsx(t,{...i,ref:n,children:a})});return s.displayName=`${r}.Slot`,s}function tt(r){const t=c.forwardRef((s,l)=>{const{children:n,...a}=s;if(c.isValidElement(n)){const i=lt(n),o=nt(a,n.props);return n.type!==c.Fragment&&(o.ref=l?Ee(l,i):i),c.cloneElement(n,o)}return c.Children.count(n)>1?c.Children.only(null):null});return t.displayName=`${r}.SlotClone`,t}var rt=Symbol("radix.slottable");function st(r){return c.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===rt}function nt(r,t){const s={...t};for(const l in t){const n=r[l],a=t[l];/^on[A-Z]/.test(l)?n&&a?s[l]=(...o)=>{const p=a(...o);return n(...o),p}:n&&(s[l]=n):l==="style"?s[l]={...n,...a}:l==="className"&&(s[l]=[n,a].filter(Boolean).join(" "))}return{...r,...s}}function lt(r){var l,n;let t=(l=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:l.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?r.ref:(t=(n=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:n.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}var L="Popover",[ne]=Ie(L,[se]),A=se(),[at,w]=ne(L),le=r=>{const{__scopePopover:t,children:s,open:l,defaultOpen:n,onOpenChange:a,modal:i=!1}=r,o=A(t),p=c.useRef(null),[u,m]=c.useState(!1),[h,d]=Te({prop:l,defaultProp:n??!1,onChange:a,caller:L});return e.jsx(ke,{...o,children:e.jsx(at,{scope:t,contentId:Se(),triggerRef:p,open:h,onOpenChange:d,onOpenToggle:c.useCallback(()=>d(x=>!x),[d]),hasCustomAnchor:u,onCustomAnchorAdd:c.useCallback(()=>m(!0),[]),onCustomAnchorRemove:c.useCallback(()=>m(!1),[]),modal:i,children:s})})};le.displayName=L;var ae="PopoverAnchor",ot=c.forwardRef((r,t)=>{const{__scopePopover:s,...l}=r,n=w(ae,s),a=A(s),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=n;return c.useEffect(()=>(i(),()=>o()),[i,o]),e.jsx(te,{...a,...l,ref:t})});ot.displayName=ae;var oe="PopoverTrigger",ie=c.forwardRef((r,t)=>{const{__scopePopover:s,...l}=r,n=w(oe,s),a=A(s),i=H(t,n.triggerRef),o=e.jsx(ee.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":pe(n.open),...l,ref:i,onClick:R(r.onClick,n.onOpenToggle)});return n.hasCustomAnchor?o:e.jsx(te,{asChild:!0,...a,children:o})});ie.displayName=oe;var U="PopoverPortal",[it,ct]=ne(U,{forceMount:void 0}),ce=r=>{const{__scopePopover:t,forceMount:s,children:l,container:n}=r,a=w(U,t);return e.jsx(it,{scope:t,forceMount:s,children:e.jsx(re,{present:s||a.open,children:e.jsx(Re,{asChild:!0,container:n,children:l})})})};ce.displayName=U;var T="PopoverContent",ue=c.forwardRef((r,t)=>{const s=ct(T,r.__scopePopover),{forceMount:l=s.forceMount,...n}=r,a=w(T,r.__scopePopover);return e.jsx(re,{present:l||a.open,children:a.modal?e.jsx(dt,{...n,ref:t}):e.jsx(ft,{...n,ref:t})})});ue.displayName=T;var ut=et("PopoverContent.RemoveScroll"),dt=c.forwardRef((r,t)=>{const s=w(T,r.__scopePopover),l=c.useRef(null),n=H(t,l),a=c.useRef(!1);return c.useEffect(()=>{const i=l.current;if(i)return Oe(i)},[]),e.jsx(_e,{as:ut,allowPinchZoom:!0,children:e.jsx(de,{...r,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:R(r.onCloseAutoFocus,i=>{var o;i.preventDefault(),a.current||(o=s.triggerRef.current)==null||o.focus()}),onPointerDownOutside:R(r.onPointerDownOutside,i=>{const o=i.detail.originalEvent,p=o.button===0&&o.ctrlKey===!0,u=o.button===2||p;a.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:R(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),ft=c.forwardRef((r,t)=>{const s=w(T,r.__scopePopover),l=c.useRef(!1),n=c.useRef(!1);return e.jsx(de,{...r,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,o;(i=r.onCloseAutoFocus)==null||i.call(r,a),a.defaultPrevented||(l.current||(o=s.triggerRef.current)==null||o.focus(),a.preventDefault()),l.current=!1,n.current=!1},onInteractOutside:a=>{var p,u;(p=r.onInteractOutside)==null||p.call(r,a),a.defaultPrevented||(l.current=!0,a.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const i=a.target;((u=s.triggerRef.current)==null?void 0:u.contains(i))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&n.current&&a.preventDefault()}})}),de=c.forwardRef((r,t)=>{const{__scopePopover:s,trapFocus:l,onOpenAutoFocus:n,onCloseAutoFocus:a,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:p,onFocusOutside:u,onInteractOutside:m,...h}=r,d=w(T,s),x=A(s);return Le(),e.jsx(Me,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:n,onUnmountAutoFocus:a,children:e.jsx(De,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:m,onEscapeKeyDown:o,onPointerDownOutside:p,onFocusOutside:u,onDismiss:()=>d.onOpenChange(!1),children:e.jsx($e,{"data-state":pe(d.open),role:"dialog",id:d.contentId,...x,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),fe="PopoverClose",ht=c.forwardRef((r,t)=>{const{__scopePopover:s,...l}=r,n=w(fe,s);return e.jsx(ee.button,{type:"button",...l,ref:t,onClick:R(r.onClick,()=>n.onOpenChange(!1))})});ht.displayName=fe;var pt="PopoverArrow",he=c.forwardRef((r,t)=>{const{__scopePopover:s,...l}=r,n=A(s);return e.jsx(Ae,{...n,...l,ref:t})});he.displayName=pt;function pe(r){return r?"open":"closed"}var xt=le,mt=ie,gt=ce,vt=ue,bt=he;const kt=c.memo(function({cell:t,rowName:s,columnIndex:l,isHighlighted:n=!1,onClick:a}){const[i,o]=c.useState(!1),p=t.result??f.NO_RESULT,u=!!t.message,m=c.useCallback(()=>{u&&o(!0),a==null||a(t)},[t,u,a]),h=c.useCallback(g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),m())},[m]),d=W(p,t.icon),x=z(p,t.icon);return e.jsxs(xt,{open:i,onOpenChange:o,children:[e.jsx(mt,{asChild:!0,children:e.jsx("button",{type:"button",className:j("h-5 w-5 rounded-sm transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",d,n&&"ring-2 ring-blue-400",u&&"cursor-pointer hover:scale-110"),title:t.message||x,onClick:m,onKeyDown:h,"aria-label":`${x}${t.message?`: ${t.message}`:""}`})}),u&&e.jsx(gt,{children:e.jsxs(vt,{className:"z-50 max-w-md rounded-lg border border-[hsl(var(--border))] bg-[hsl(var(--popover))] p-3 shadow-lg",sideOffset:5,align:"center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:j("h-3 w-3 rounded-sm",d)}),e.jsx("span",{className:"font-medium text-sm",children:x})]}),s&&e.jsxs("div",{className:"text-xs text-[hsl(var(--muted-foreground))]",children:[e.jsx("span",{className:"font-medium",children:"Test:"})," ",s]}),l!==void 0&&e.jsxs("div",{className:"text-xs text-[hsl(var(--muted-foreground))]",children:[e.jsx("span",{className:"font-medium",children:"Build:"})," #",l+1]}),e.jsx("div",{className:"pt-1 border-t border-[hsl(var(--border))]",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words max-h-48 overflow-auto font-mono text-[hsl(var(--foreground))]",children:t.message})})]}),e.jsx(bt,{className:"fill-[hsl(var(--popover))]"})]})})]})}),xe=c.memo(function({cell:t,isHighlighted:s=!1,onSelect:l}){const n=t.result??f.NO_RESULT,a=W(n,t.icon),i=z(n,t.icon),o=!!t.message,p=u=>{(u.key==="Enter"||u.key===" ")&&o&&l&&(u.preventDefault(),l())};return e.jsx("div",{role:o?"button":"gridcell",tabIndex:o?0:-1,className:j("h-5 w-5 rounded-sm mx-auto focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",a,s&&"ring-2 ring-blue-400",o&&"cursor-pointer hover:scale-110"),title:t.message||i,onClick:o?l:void 0,onKeyDown:p,"aria-label":`${i}${t.message?`: ${t.message}`:""}`})});function W(r,t){if(t==="F")return"bg-red-500";switch(r){case f.PASS:case f.PASS_WITH_ERRORS:case f.PASS_WITH_SKIPS:return"bg-green-500";case f.FAIL:case f.BUILD_FAIL:case f.CATEGORIZED_FAIL:case f.FAIL_EXPECTED:return"bg-red-500";case f.FLAKY:case f.CATEGORIZED_INTERMITTENT_FAIL:return"bg-orange-500";case f.SKIPPED:return"bg-yellow-500";case f.RUNNING:return"bg-blue-500 animate-pulse";case f.TRUNCATED:return"bg-gray-400";case f.CANCEL:case f.TIMEOUT:case f.CATEGORIZED_ABORT:return"bg-purple-500";case f.NO_RESULT:case f.UNKNOWN:default:return"bg-gray-200 dark:bg-gray-700"}}function z(r,t){if(t==="F")return"Fail";switch(r){case f.PASS:return"Pass";case f.PASS_WITH_ERRORS:return"Pass (with errors)";case f.PASS_WITH_SKIPS:return"Pass (with skips)";case f.FAIL:return"Fail";case f.BUILD_FAIL:return"Build Fail";case f.CATEGORIZED_FAIL:return"Categorized Fail";case f.FAIL_EXPECTED:return"Fail (expected)";case f.FLAKY:return"Flaky";case f.CATEGORIZED_INTERMITTENT_FAIL:return"Intermittent Fail";case f.SKIPPED:return"Skipped";case f.RUNNING:return"Running";case f.TRUNCATED:return"Truncated";case f.CANCEL:return"Cancelled";case f.TIMEOUT:return"Timeout";case f.CATEGORIZED_ABORT:return"Aborted";case f.NO_RESULT:return"No result";case f.UNKNOWN:return"Unknown";default:return`Result: ${r}`}}const jt=c.memo(function({row:t,rowIndex:s,cellWidth:l,rowNameWidth:n,rowHeight:a,style:i,visibleCellStart:o,visibleCellEnd:p,headerCount:u,scrollLeft:m,highlightedRow:h,highlightedColumn:d,onRowHover:x,onCellSelect:g}){const b=h===s,C=u*l,y=Math.min(p,t.cells.length-1),E=o<=y?t.cells.slice(o,y+1):[],M=c.useCallback(()=>{x==null||x(s)},[x,s]),O=c.useCallback(()=>{x==null||x(null)},[x]);return e.jsxs("div",{className:j("flex border-b border-[hsl(var(--border))] transition-colors",b&&"bg-blue-50 dark:bg-blue-900/20"),style:{...i,height:a},role:"row","aria-rowindex":s+1,onMouseEnter:M,onMouseLeave:O,children:[e.jsx("div",{className:j("sticky left-0 z-10 flex-shrink-0 flex items-center px-3 border-r border-[hsl(var(--border))] bg-[hsl(var(--background))]",b&&"bg-blue-50 dark:bg-blue-900/20"),style:{width:n},role:"rowheader",children:e.jsx("span",{className:"truncate text-sm",title:t.name,children:t.name})}),e.jsx("div",{className:"relative flex-1 overflow-hidden min-w-0",children:e.jsx("div",{style:{position:"relative",width:C,height:a,transform:`translateX(-${m}px)`},children:E.map((F,D)=>{const P=o+D,$=d===P||b;return e.jsx("div",{className:j("flex items-center justify-center",d===P&&"bg-blue-100/50 dark:bg-blue-900/20"),style:{position:"absolute",left:P*l,width:l,height:a},role:"gridcell",children:e.jsx(xe,{cell:F,isHighlighted:$,onSelect:F.message?()=>g==null?void 0:g(s,P,F):void 0})},P)})})})]})}),St=c.memo(function({row:t,rowIndex:s,cellWidth:l,rowNameWidth:n,rowHeight:a,highlightedRow:i,highlightedColumn:o,onRowHover:p,onCellSelect:u}){const m=i===s,h=c.useCallback(()=>{p==null||p(s)},[p,s]),d=c.useCallback(()=>{p==null||p(null)},[p]);return e.jsxs("div",{className:j("flex border-b border-[hsl(var(--border))] transition-colors",m&&"bg-blue-50 dark:bg-blue-900/20"),style:{height:a},role:"row","aria-rowindex":s+1,onMouseEnter:h,onMouseLeave:d,children:[e.jsx("div",{className:j("sticky left-0 z-10 flex-shrink-0 flex items-center px-3 border-r border-[hsl(var(--border))] bg-[hsl(var(--background))]",m&&"bg-blue-50 dark:bg-blue-900/20"),style:{width:n},role:"rowheader",children:e.jsx("span",{className:"truncate text-sm",title:t.name,children:t.name})}),e.jsx("div",{className:"flex items-center",children:t.cells.map((x,g)=>{const b=o===g||m;return e.jsx("div",{className:j("flex-shrink-0 flex items-center justify-center",o===g&&"bg-blue-100/50 dark:bg-blue-900/20"),style:{width:l,height:a},role:"gridcell",children:e.jsx(xe,{cell:x,isHighlighted:b,onSelect:x.message?()=>u==null?void 0:u(s,g,x):void 0})},g)})})]})}),Rt=c.memo(function({headers:t,visibleStartIndex:s,visibleEndIndex:l,cellWidth:n,rowNameWidth:a,highlightedColumn:i,onColumnHover:o}){const p=t.slice(s,l+1),u=t.length*n;return e.jsxs("div",{className:"sticky top-0 z-20 flex bg-[hsl(var(--muted))] border-b border-[hsl(var(--border))]",role:"row",children:[e.jsx("div",{className:"sticky left-0 z-30 flex-shrink-0 flex items-center px-3 py-2 bg-[hsl(var(--muted))] border-r border-[hsl(var(--border))] font-medium text-sm",style:{width:a},role:"columnheader",children:"Test Name"}),e.jsx("div",{className:"relative flex-1 overflow-hidden min-w-0",children:e.jsxs("div",{className:"flex",style:{width:u,transform:`translateX(-${s*n}px)`},children:[e.jsx("div",{style:{width:s*n,flexShrink:0}}),p.map((m,h)=>{const d=s+h,x=i===d;return e.jsxs("div",{className:j("flex-shrink-0 flex flex-col items-center justify-center py-1 px-0.5 text-center transition-colors",x&&"bg-blue-100 dark:bg-blue-900/30"),style:{width:n},role:"columnheader",onMouseEnter:()=>o==null?void 0:o(d),onMouseLeave:()=>o==null?void 0:o(null),title:ge(m,d),children:[e.jsx("span",{className:"text-[10px] font-medium text-[hsl(var(--muted-foreground))] leading-tight",children:d+1}),m.started&&e.jsx("span",{className:"text-[9px] text-[hsl(var(--muted-foreground))] leading-tight truncate w-full",children:me(m.started)})]},d)})]})})]})});function me(r){try{const t=new Date(r),l=new Date().getTime()-t.getTime(),n=Math.floor(l/(1e3*60*60)),a=Math.floor(n/24);return n<1?"now":n<24?`${n}h`:a<7?`${a}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function ge(r,t){const s=[`Build #${t+1}`];if(r.build&&s.push(`ID: ${r.build}`),r.started)try{const l=new Date(r.started);s.push(`Started: ${l.toLocaleString()}`)}catch{s.push(`Started: ${r.started}`)}if(r.extra&&r.extra.length>0){const l=r.extra.filter(n=>n&&n.trim()!=="");l.length>0&&s.push(`Extra: ${l.join(", ")}`)}return s.join(`
`)}const yt=c.memo(function({headers:t,cellWidth:s,rowNameWidth:l,scrollLeft:n}){const a=t.length*s;return e.jsxs("div",{className:"sticky top-0 z-20 flex bg-[hsl(var(--muted))] border-b border-[hsl(var(--border))]",children:[e.jsx("div",{className:"sticky left-0 z-30 flex-shrink-0 flex items-center px-3 py-2 bg-[hsl(var(--muted))] border-r border-[hsl(var(--border))] font-medium text-sm",style:{width:l},children:"Test Name"}),e.jsx("div",{className:"overflow-hidden flex-1 min-w-0",children:e.jsx("div",{className:"flex",style:{width:a,transform:`translateX(-${n}px)`},children:t.map((i,o)=>e.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center py-1 px-0.5 text-center",style:{width:s},title:ge(i,o),children:[e.jsx("span",{className:"text-[10px] font-medium text-[hsl(var(--muted-foreground))] leading-tight",children:o+1}),i.started&&e.jsx("span",{className:"text-[9px] text-[hsl(var(--muted-foreground))] leading-tight",children:me(i.started)})]},o))})})]})}),_={statusFilter:"all",textFilter:"",showOnlyFailures:!1},ve=ye()(Ne((r,t)=>({filters:{},getFilterKey:(s,l)=>`${s}/${l}`,getFilters:(s,l)=>{const n=t().getFilterKey(s,l);return t().filters[n]??_},setStatusFilter:(s,l,n)=>{const a=t().getFilterKey(s,l);r(i=>({filters:{...i.filters,[a]:{..._,...i.filters[a],statusFilter:n}}}))},setTextFilter:(s,l,n)=>{const a=t().getFilterKey(s,l);r(i=>({filters:{...i.filters,[a]:{..._,...i.filters[a],textFilter:n}}}))},setShowOnlyFailures:(s,l,n)=>{const a=t().getFilterKey(s,l);r(i=>({filters:{...i.filters,[a]:{..._,...i.filters[a],showOnlyFailures:n}}}))},clearFilters:(s,l)=>{const n=t().getFilterKey(s,l);r(a=>{const{[n]:i,...o}=a.filters;return{filters:o}})},clearAllFilters:()=>{r({filters:{}})}}),{name:"pano:filters"})),Y=[{value:"all",label:"All statuses"},{value:"pass",label:"Passing",color:"bg-green-500"},{value:"fail",label:"Failing",color:"bg-red-500"},{value:"skip",label:"Skipped",color:"bg-yellow-500"},{value:"flaky",label:"Flaky",color:"bg-orange-500"},{value:"empty",label:"No result",color:"bg-gray-400"}];function Nt({dashboard:r,tab:t,totalRows:s,filteredRows:l}){const{getFilters:n,setStatusFilter:a,setTextFilter:i,setShowOnlyFailures:o,clearFilters:p}=ve(),u=n(r,t),m=u.statusFilter!=="all"||u.textFilter!==""||u.showOnlyFailures,h=Y.find(d=>d.value===u.statusFilter);return e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 bg-[hsl(var(--muted))] border-b border-[hsl(var(--border))]",children:[e.jsxs("div",{className:"relative flex-1 max-w-xs",children:[e.jsx(Ce,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-[hsl(var(--muted-foreground))]"}),e.jsx("input",{type:"text",placeholder:"Filter tests by name...",value:u.textFilter,onChange:d=>i(r,t,d.target.value),className:"w-full pl-8 pr-8 py-1.5 text-sm rounded-md border border-[hsl(var(--border))] bg-[hsl(var(--background))] outline-none focus:ring-2 focus:ring-[hsl(var(--ring))] placeholder:text-[hsl(var(--muted-foreground))]"}),u.textFilter&&e.jsx("button",{onClick:()=>i(r,t,""),className:"absolute right-2 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-[hsl(var(--muted))]",children:e.jsx(G,{className:"h-3.5 w-3.5 text-[hsl(var(--muted-foreground))]"})})]}),e.jsxs(Ke,{children:[e.jsx(Ge,{asChild:!0,children:e.jsxs("button",{className:j("inline-flex items-center gap-2 px-3 py-1.5 text-sm rounded-md border border-[hsl(var(--border))] bg-[hsl(var(--background))] hover:bg-[hsl(var(--accent))]",u.statusFilter!=="all"&&"border-[hsl(var(--primary))]"),children:[e.jsx(Je,{className:"h-4 w-4"}),(h==null?void 0:h.color)&&e.jsx("span",{className:j("h-2.5 w-2.5 rounded-full",h.color)}),e.jsx("span",{children:(h==null?void 0:h.label)??"All statuses"})]})}),e.jsx(Ue,{children:e.jsx(We,{className:"min-w-[160px] rounded-md border border-[hsl(var(--border))] bg-[hsl(var(--background))] p-1 shadow-md z-50",sideOffset:5,children:Y.map(d=>e.jsxs(ze,{className:j("flex items-center gap-2 px-2 py-1.5 text-sm rounded cursor-pointer outline-none","hover:bg-[hsl(var(--accent))] focus:bg-[hsl(var(--accent))]",u.statusFilter===d.value&&"bg-[hsl(var(--accent))]"),onClick:()=>a(r,t,d.value),children:[d.color?e.jsx("span",{className:j("h-2.5 w-2.5 rounded-full",d.color)}):e.jsx("span",{className:"h-2.5 w-2.5"}),d.label]},d.value))})})]}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:u.showOnlyFailures,onChange:d=>o(r,t,d.target.checked),className:"h-4 w-4 rounded border-[hsl(var(--border))] text-[hsl(var(--primary))] focus:ring-[hsl(var(--ring))]"}),e.jsx(we,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-[hsl(var(--muted-foreground))]",children:"Failures only"})]}),e.jsx("div",{className:"h-6 w-px bg-[hsl(var(--border))]"}),e.jsx("span",{className:"text-xs text-[hsl(var(--muted-foreground))]","aria-live":"polite","aria-atomic":"true",children:l===s?`${s.toLocaleString()} tests`:`${l.toLocaleString()} of ${s.toLocaleString()} tests`}),m&&e.jsxs("button",{onClick:()=>p(r,t),className:"inline-flex items-center gap-1.5 px-2 py-1 text-xs text-[hsl(var(--muted-foreground))] hover:text-[hsl(var(--foreground))] rounded hover:bg-[hsl(var(--background))]",children:[e.jsx(G,{className:"h-3.5 w-3.5"}),"Clear filters"]})]})}const S=28,q=32,I=350,J=5;function Ct(r,t){if(t==="all")return!0;for(const s of r.cells.slice(0,10)){const l=s.result??0;switch(t){case"pass":if(Pe(l))return!0;break;case"fail":if(s.icon==="F"||Q(l))return!0;break;case"skip":if(l===f.SKIPPED)return!0;break;case"flaky":if(l===f.FLAKY||l===f.CATEGORIZED_INTERMITTENT_FAIL)return!0;break;case"empty":if(l===f.NO_RESULT)return!0;break}}return!1}function wt(r){return r.cells.some(t=>t.icon==="F"?!0:Q(t.result??0))}function At({headers:r,rows:t,className:s,maxHeight:l=600,dashboardName:n,tabName:a}){var B,Z,X;const[i,o]=c.useState(null),[p]=c.useState(null),[u,m]=c.useState(0),[h,d]=c.useState(null),x=c.useRef(null),{height:g,containerRef:b}=He(l),C=ve(v=>n&&a?v.getFilters(n,a):null),y=c.useMemo(()=>C?t.filter(v=>{if(C.textFilter){const N=C.textFilter.toLowerCase();if(!v.name.toLowerCase().includes(N))return!1}return!(C.statusFilter!=="all"&&!Ct(v,C.statusFilter)||C.showOnlyFailures&&!wt(v))}):t,[t,C]),{virtualItems:E,totalHeight:M,onScroll:O,scrollRef:F}=Qe({itemCount:y.length,itemHeight:q,containerHeight:Math.min(g,l)-80,overscan:10}),{visibleCellStart:D,visibleCellEnd:P}=c.useMemo(()=>{var k;const v=(((k=x.current)==null?void 0:k.clientWidth)??800)-I,N=Math.max(0,Math.floor(u/S)-J),K=Math.min(r.length-1,Math.ceil((u+v)/S)+J);return{visibleCellStart:N,visibleCellEnd:K}},[u,r.length]),$=c.useCallback(v=>{const N=v.currentTarget;m(N.scrollLeft),O(v)},[O]),be=c.useCallback((v,N,K)=>{const k=y[v];k&&d({row:k,rowIndex:v,cellIndex:N,cell:K})},[y]),V=r.length*S+I;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:b,className:j("rounded-lg border border-[hsl(var(--border))] bg-[hsl(var(--background))] overflow-hidden",s),children:[n&&a&&e.jsx(Nt,{dashboard:n,tab:a,totalRows:t.length,filteredRows:y.length}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-[hsl(var(--muted)/0.5)] border-b border-[hsl(var(--border))] text-xs text-[hsl(var(--muted-foreground))]",children:[e.jsxs("span",{children:[y.length.toLocaleString()," tests Ã— ",r.length.toLocaleString()," builds"]}),e.jsxs("span",{children:["Showing rows ",((B=E[0])==null?void 0:B.index)+1||0," -"," ",((Z=E[E.length-1])==null?void 0:Z.index)+1||0," of ",y.length]})]}),e.jsxs("div",{ref:v=>{x.current=v,F&&"current"in F&&(F.current=v)},className:"overflow-auto",style:{maxHeight:l-80},onScroll:$,role:"grid","aria-rowcount":y.length,"aria-colcount":r.length+1,children:[e.jsx(yt,{headers:r,cellWidth:S,rowNameWidth:I,scrollLeft:u}),y.length===0?e.jsx("div",{className:"flex items-center justify-center py-12 text-sm text-[hsl(var(--muted-foreground))]",children:"No tests match the current filters"}):e.jsx("div",{className:"relative z-0",style:{height:M,width:V},children:E.map(v=>{const N=y[v.index];return N?e.jsx(jt,{row:N,rowIndex:v.index,cellWidth:S,rowNameWidth:I,rowHeight:q,style:{position:"absolute",top:v.offsetTop,left:0,width:V},visibleCellStart:D,visibleCellEnd:P,headerCount:r.length,scrollLeft:u,highlightedRow:i??void 0,highlightedColumn:p??void 0,onRowHover:o,onCellSelect:be},v.index):null})})]})]}),e.jsx(Ve,{open:!!h,onOpenChange:v=>!v&&d(null),children:e.jsxs(Be,{children:[e.jsx(Ze,{className:"fixed inset-0 bg-black/50 z-50"}),e.jsx(Xe,{className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-50 max-w-2xl w-full max-h-[85vh] rounded-lg border border-[hsl(var(--border))] bg-[hsl(var(--background))] shadow-lg overflow-hidden",children:h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[hsl(var(--border))]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:j("h-4 w-4 rounded",W(h.cell.result??0,h.cell.icon))}),e.jsx(Ye,{className:"font-semibold",children:z(h.cell.result??0,h.cell.icon)})]}),e.jsx(qe,{className:"rounded-md p-1 hover:bg-[hsl(var(--muted))]",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-auto max-h-[calc(85vh-60px)]",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wide",children:"Test Name"}),e.jsx("p",{className:"mt-1 text-sm font-mono break-all",children:h.row.name})]}),n&&a&&e.jsx(Fe,{target:{type:"test",dashboardName:n,tabName:a,testName:h.row.name},variant:"outline",size:"sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wide",children:"Build"}),e.jsxs("p",{className:"mt-1 text-sm",children:["#",h.cellIndex+1]})]}),((X=r[h.cellIndex])==null?void 0:X.started)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wide",children:"Started"}),e.jsx("p",{className:"mt-1 text-sm",children:new Date(r[h.cellIndex].started).toLocaleString()})]})]}),h.cell.message&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wide",children:"Message"}),e.jsx("pre",{className:"mt-2 p-3 rounded-md bg-[hsl(var(--muted))] text-sm font-mono whitespace-pre-wrap break-words overflow-auto max-h-64",children:h.cell.message})]})]})]})})]})})]})}export{S as CELL_WIDTH,Nt as FilterToolbar,kt as GridCell,Rt as GridHeader,q as ROW_HEIGHT,I as ROW_NAME_WIDTH,yt as SimpleGridHeader,St as SimpleRow,At as TestGrid,xe as VirtualGridCell,jt as VirtualRow,W as getCellColor,z as getResultLabel};
